{"ast":null,"code":"import { ElementRef } from '@angular/core';\nimport { HttpClient, HttpEventType } from '@angular/common/http';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/platform-browser\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = [\"fileInputSingle\"];\nfunction CompressImageComponent_header_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"header\", 5)(1, \"h1\");\n    i0.ɵɵtext(2, \"\\uD83D\\uDE80 Image Tools\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4, \"Every tool you need to work with your images, all in one place.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CompressImageComponent_main_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"main\", 6)(1, \"div\", 7);\n    i0.ɵɵlistener(\"click\", function CompressImageComponent_main_2_Template_div_click_1_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.setActiveTool(\"compress-image\"));\n    });\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵelement(3, \"i\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"h3\", 10);\n    i0.ɵɵtext(5, \"Compress Image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 11);\n    i0.ɵɵtext(7, \"Reduce the file size of your JPG, PNG, and other images.\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction CompressImageComponent_div_3_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"button\", 22);\n    i0.ɵɵtext(2, \"Select Image File\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 23)(4, \"button\", 24);\n    i0.ɵɵelement(5, \"i\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 24);\n    i0.ɵɵelement(7, \"i\", 26);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"span\", 27);\n    i0.ɵɵtext(9, \"or drop image here\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction CompressImageComponent_div_3_ng_container_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 28)(2, \"div\", 29);\n    i0.ɵɵelement(3, \"i\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 31);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"span\", 32);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"button\", 33);\n    i0.ɵɵlistener(\"click\", function CompressImageComponent_div_3_ng_container_12_Template_button_click_8_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      $event.stopPropagation();\n      return i0.ɵɵresetView(ctx_r1.resetSingleFile());\n    });\n    i0.ɵɵelement(9, \"i\", 34);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.selectedFile.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", (ctx_r1.selectedFile.size / 1024).toFixed(1), \" KB)\");\n  }\n}\nfunction CompressImageComponent_div_3_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"progress\", 35);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r1.progress, \"%\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"value\", ctx_r1.progress);\n  }\n}\nfunction CompressImageComponent_div_3_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"a\", 36);\n    i0.ɵɵtext(4, \"\\u2B07 Download\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\\u2705 Compressed Size: \", (ctx_r1.compressedSize / 1024).toFixed(1), \" KB\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"href\", ctx_r1.downloadUrl, i0.ɵɵsanitizeUrl)(\"download\", ctx_r1.downloadedFileName);\n  }\n}\nfunction CompressImageComponent_div_3_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 37);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \\u274C \", ctx_r1.errorMessage, \" \");\n  }\n}\nfunction CompressImageComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function CompressImageComponent_div_3_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.setActiveTool(null));\n    });\n    i0.ɵɵtext(2, \" \\u2190 Back to Tools \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h2\");\n    i0.ɵɵtext(4, \"Compress Image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 14)(6, \"div\", 15)(7, \"label\", 16);\n    i0.ɵɵlistener(\"dragover\", function CompressImageComponent_div_3_Template_label_dragover_7_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onDragOverSingle($event));\n    })(\"dragleave\", function CompressImageComponent_div_3_Template_label_dragleave_7_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onDragLeaveSingle($event));\n    })(\"drop\", function CompressImageComponent_div_3_Template_label_drop_7_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onDropSingle($event));\n    });\n    i0.ɵɵelementStart(8, \"input\", 17, 0);\n    i0.ɵɵlistener(\"change\", function CompressImageComponent_div_3_Template_input_change_8_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onFileSelectedSingle($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 18);\n    i0.ɵɵlistener(\"click\", function CompressImageComponent_div_3_Template_div_click_10_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const fileInputSingle_r4 = i0.ɵɵreference(9);\n      return i0.ɵɵresetView(fileInputSingle_r4.click());\n    });\n    i0.ɵɵtemplate(11, CompressImageComponent_div_3_ng_container_11_Template, 10, 0, \"ng-container\", 19)(12, CompressImageComponent_div_3_ng_container_12_Template, 10, 2, \"ng-container\", 19);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(13, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function CompressImageComponent_div_3_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.uploadSingleFile());\n    });\n    i0.ɵɵtext(14, \"\\u26A1 Compress\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(15, CompressImageComponent_div_3_div_15_Template, 4, 2, \"div\", 19)(16, CompressImageComponent_div_3_div_16_Template, 5, 3, \"div\", 19)(17, CompressImageComponent_div_3_div_17_Template, 2, 1, \"div\", 21);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵclassProp(\"drag-over\", ctx_r1.isDragging);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.selectedFile);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedFile);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", !ctx_r1.selectedFile || ctx_r1.progress > 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.progress > 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.downloadUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.errorMessage);\n  }\n}\nexport let CompressImageComponent = /*#__PURE__*/(() => {\n  class CompressImageComponent {\n    http;\n    sanitizer;\n    fileInput;\n    activeTool = null;\n    selectedFile = null;\n    previewUrl = '';\n    blobUrl = '';\n    downloadUrl = '';\n    originalSize = 0;\n    compressedSize = 0;\n    progress = 0;\n    errorMessage = null;\n    isDragging = false;\n    downloadedFileName = '';\n    constructor(http, sanitizer) {\n      this.http = http;\n      this.sanitizer = sanitizer;\n    }\n    ngOnInit() {\n      this.activeTool = null; // default\n    }\n    setActiveTool(tool) {\n      console.log('Tool changed to:', tool);\n      this.activeTool = tool;\n      this.resetSingleFile();\n    }\n    triggerFileInput() {\n      this.fileInput.nativeElement.click();\n    }\n    preventDefaults(event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n    onDragOverSingle(event) {\n      this.preventDefaults(event);\n      this.isDragging = true;\n    }\n    onDragLeaveSingle(event) {\n      this.preventDefaults(event);\n      this.isDragging = false;\n    }\n    onDropSingle(event) {\n      this.preventDefaults(event);\n      this.isDragging = false;\n      const file = event.dataTransfer?.files?.[0];\n      if (file?.type.startsWith('image/')) {\n        this.setFile(file);\n      } else {\n        this.errorMessage = 'Please drop a valid image file.';\n        this.resetSingleFile();\n      }\n    }\n    onFileSelectedSingle(event) {\n      const input = event.target;\n      const file = input.files?.[0];\n      if (file) this.setFile(file);\n    }\n    setFile(file) {\n      this.revokeObjectUrls();\n      this.selectedFile = file;\n      this.previewUrl = this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(file));\n      this.originalSize = file.size;\n      this.downloadUrl = '';\n      this.progress = 0;\n      this.compressedSize = 0;\n      this.errorMessage = null;\n    }\n    uploadSingleFile() {\n      if (!this.selectedFile) {\n        this.errorMessage = 'Please select an image.';\n        return;\n      }\n      const formData = new FormData();\n      formData.append('file', this.selectedFile);\n      this.http.post(`${environment.apiUrl}/compress-image`, formData, {\n        reportProgress: true,\n        observe: 'events',\n        responseType: 'blob'\n      }).subscribe(event => {\n        if (event.type === HttpEventType.UploadProgress && event.total) {\n          this.progress = Math.round(event.loaded / event.total * 100);\n        }\n        if (event.type === HttpEventType.Response) {\n          const blob = new Blob([event.body], {\n            type: 'image/jpeg'\n          });\n          this.compressedSize = blob.size;\n          this.blobUrl = URL.createObjectURL(blob);\n          this.downloadUrl = this.blobUrl;\n          this.downloadedFileName = 'compressed_' + this.selectedFile.name;\n          this.progress = 100;\n        }\n      }, err => {\n        this.errorMessage = 'Compression failed.';\n        this.progress = 0;\n      });\n    }\n    resetSingleFile() {\n      this.selectedFile = null;\n      this.previewUrl = '';\n      this.downloadUrl = '';\n      this.progress = 0;\n      this.compressedSize = 0;\n      this.originalSize = 0;\n      this.errorMessage = null;\n      if (this.fileInput?.nativeElement) {\n        this.fileInput.nativeElement.value = '';\n      }\n      this.revokeObjectUrls();\n    }\n    revokeObjectUrls() {\n      if (this.blobUrl?.startsWith('blob:')) {\n        URL.revokeObjectURL(this.blobUrl);\n      }\n      if (this.previewUrl && this.previewUrl.changingThisBreaksApplicationSecurity) {\n        URL.revokeObjectURL(this.previewUrl.changingThisBreaksApplicationSecurity);\n      }\n    }\n    static ɵfac = function CompressImageComponent_Factory(t) {\n      return new (t || CompressImageComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.DomSanitizer));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CompressImageComponent,\n      selectors: [[\"app-compress-image\"]],\n      viewQuery: function CompressImageComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.fileInput = _t.first);\n        }\n      },\n      decls: 4,\n      vars: 3,\n      consts: [[\"fileInputSingle\", \"\"], [1, \"docuflow-container\"], [\"class\", \"main-header\", 4, \"ngIf\"], [\"class\", \"tool-grid-container\", 4, \"ngIf\"], [\"class\", \"tool-workspace-wrapper\", 4, \"ngIf\"], [1, \"main-header\"], [1, \"tool-grid-container\"], [1, \"tool-card\", 3, \"click\"], [1, \"tool-icon-wrapper\", \"bg-purple\"], [1, \"fas\", \"fa-compress\"], [1, \"tool-title\"], [1, \"tool-description\"], [1, \"tool-workspace-wrapper\"], [1, \"back-to-grid-btn\", 3, \"click\"], [1, \"main-upload-content\"], [1, \"upload-area-container\"], [1, \"upload-box\", \"main-select-button\", 3, \"dragover\", \"dragleave\", \"drop\"], [\"type\", \"file\", \"accept\", \"image/*\", \"hidden\", \"\", 3, \"change\"], [1, \"upload-content\", 3, \"click\"], [4, \"ngIf\"], [3, \"click\", \"disabled\"], [\"class\", \"error\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"select-pdf-file-btn\"], [1, \"select-pdf-file-btn-alt-icons\"], [1, \"small-icon-btn\"], [1, \"fas\", \"fa-cloud-upload-alt\"], [1, \"fas\", \"fa-exchange-alt\"], [1, \"or-drop-text\"], [1, \"file-preview-area\"], [1, \"file-thumbnail\"], [1, \"fas\", \"fa-file-image\", \"file-image-icon\"], [1, \"file-name-display\"], [1, \"file-size-display\"], [\"type\", \"button\", 1, \"remove-file-preview-btn\", 3, \"click\"], [1, \"fas\", \"fa-times-circle\"], [\"max\", \"100\", 3, \"value\"], [3, \"href\", \"download\"], [1, \"error\"]],\n      template: function CompressImageComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 1);\n          i0.ɵɵtemplate(1, CompressImageComponent_header_1_Template, 5, 0, \"header\", 2)(2, CompressImageComponent_main_2_Template, 8, 0, \"main\", 3)(3, CompressImageComponent_div_3_Template, 18, 8, \"div\", 4);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.activeTool);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.activeTool);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.activeTool === \"compress-image\");\n        }\n      },\n      dependencies: [i3.NgIf]\n    });\n  }\n  return CompressImageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}