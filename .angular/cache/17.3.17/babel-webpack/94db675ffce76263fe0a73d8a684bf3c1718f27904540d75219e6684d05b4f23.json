{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { HttpClient, HttpClientModule } from '@angular/common/http';\nimport { FormsModule } from '@angular/forms';\nimport { QuillModule } from 'ngx-quill';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"ngx-quill\";\nconst _c0 = () => ({\n  height: \"300px\"\n});\nfunction WordEditComponent_quill_editor_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"quill-editor\", 6);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function WordEditComponent_quill_editor_6_Template_quill_editor_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.editorContent, $event) || (ctx_r1.editorContent = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.editorContent);\n    i0.ɵɵproperty(\"modules\", ctx_r1.editorModules)(\"styles\", i0.ɵɵpureFunction0(3, _c0));\n  }\n}\nfunction WordEditComponent_a_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 7);\n    i0.ɵɵtext(1, \" \\u2B07\\uFE0F Download Edited Word\\n\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"href\", ctx_r1.downloadUrl, i0.ɵɵsanitizeUrl);\n  }\n}\nexport let WordEditComponent = /*#__PURE__*/(() => {\n  class WordEditComponent {\n    http;\n    rawFile = null;\n    fileName = '';\n    editorContent = '';\n    editorVisible = false;\n    downloadUrl = null;\n    editorModules = {\n      toolbar: [[{\n        header: [1, 2, 3, false]\n      }], ['bold', 'italic', 'underline', 'strike'], [{\n        list: 'ordered'\n      }, {\n        list: 'bullet'\n      }], [{\n        align: []\n      }], ['link', 'clean']]\n    };\n    constructor(http) {\n      this.http = http;\n    }\n    // Step 1: User selects a .docx file\n    onFileSelected(event) {\n      const input = event.target;\n      if (input.files?.length) {\n        const file = input.files[0];\n        if (file.name.endsWith('.docx')) {\n          this.rawFile = file;\n          this.fileName = file.name;\n          this.editorVisible = false;\n          this.editorContent = '';\n          this.downloadUrl = null; // reset old download link\n        } else {\n          alert('Please upload a valid .docx file.');\n        }\n      }\n    }\n    // Step 2: View and load DOCX content as HTML\n    viewContent() {\n      if (!this.rawFile) return;\n      const formData = new FormData();\n      formData.append('file', this.rawFile);\n      this.http.post(`${environment.apiUrl}/word-to-html`, formData, {\n        responseType: 'text'\n      }).subscribe({\n        next: htmlContent => {\n          this.editorContent = htmlContent.trim();\n          this.editorVisible = true;\n        },\n        error: err => {\n          console.error('❌ Error loading Word content:', err);\n          alert('Failed to load Word content.');\n        }\n      });\n    }\n    // Step 3: Save edited content as .docx file\n    saveEditedContent() {\n      if (!this.editorContent.trim()) {\n        alert('Editor is empty!');\n        return;\n      }\n      const blob = new Blob([this.editorContent], {\n        type: 'text/html'\n      });\n      const htmlFile = new File([blob], 'edited.html');\n      const formData = new FormData();\n      formData.append('file', htmlFile);\n      this.http.post(`${environment.apiUrl}/html-to-word`, formData, {\n        responseType: 'blob'\n      }).subscribe({\n        next: docxBlob => {\n          if (this.downloadUrl) {\n            URL.revokeObjectURL(this.downloadUrl); // Clean previous blob\n          }\n          // ✅ Just store the blob URL for download, don't trigger it\n          this.downloadUrl = window.URL.createObjectURL(docxBlob);\n          alert('✅ File ready! Click the \"⬇️ Download Edited Word\" link to download.');\n        },\n        error: err => {\n          console.error('❌ Error saving DOCX:', err);\n          alert('Failed to save Word file.');\n        }\n      });\n    }\n    static ɵfac = function WordEditComponent_Factory(t) {\n      return new (t || WordEditComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: WordEditComponent,\n      selectors: [[\"app-word-edit\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 10,\n      vars: 4,\n      consts: [[1, \"container\"], [\"type\", \"file\", \"accept\", \".docx\", 3, \"change\"], [3, \"click\", \"disabled\"], [3, \"ngModel\", \"modules\", \"styles\", \"ngModelChange\", 4, \"ngIf\"], [1, \"save-btn\", 3, \"click\", \"disabled\"], [\"download\", \"edited.docx\", 3, \"href\", 4, \"ngIf\"], [3, \"ngModelChange\", \"ngModel\", \"modules\", \"styles\"], [\"download\", \"edited.docx\", 3, \"href\"]],\n      template: function WordEditComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"\\uD83D\\uDCDD Word Editor\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"input\", 1);\n          i0.ɵɵlistener(\"change\", function WordEditComponent_Template_input_change_3_listener($event) {\n            return ctx.onFileSelected($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function WordEditComponent_Template_button_click_4_listener() {\n            return ctx.viewContent();\n          });\n          i0.ɵɵtext(5, \"\\uD83D\\uDC41\\uFE0F View\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(6, WordEditComponent_quill_editor_6_Template, 1, 4, \"quill-editor\", 3);\n          i0.ɵɵelementStart(7, \"button\", 4);\n          i0.ɵɵlistener(\"click\", function WordEditComponent_Template_button_click_7_listener() {\n            return ctx.saveEditedContent();\n          });\n          i0.ɵɵtext(8, \"\\uD83D\\uDCBE Save\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(9, WordEditComponent_a_9_Template, 2, 1, \"a\", 5);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"disabled\", !ctx.rawFile);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.editorVisible);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"disabled\", !ctx.editorContent);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.downloadUrl);\n        }\n      },\n      dependencies: [CommonModule, i2.NgIf, HttpClientModule, FormsModule, i3.NgControlStatus, i3.NgModel, QuillModule, i4.QuillEditorComponent]\n    });\n  }\n  return WordEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}