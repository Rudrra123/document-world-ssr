{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { HttpClient, HttpClientModule } from '@angular/common/http';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction WordEditComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"h3\");\n    i0.ɵɵtext(2, \"Editor\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"textarea\", 2);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function WordEditComponent_div_3_Template_textarea_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.editorContent, $event) || (ctx_r1.editorContent = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵelementStart(5, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function WordEditComponent_div_3_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.saveEditedContent());\n    });\n    i0.ɵɵtext(6, \"\\uD83D\\uDCBE Save as .docx\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.editorContent);\n  }\n}\nexport let WordEditComponent = /*#__PURE__*/(() => {\n  class WordEditComponent {\n    http;\n    editorContent = '';\n    fileName = '';\n    constructor(http) {\n      this.http = http;\n    }\n    onFileSelected(event) {\n      const file = event.target.files[0];\n      if (file && file.name.endsWith('.docx')) {\n        this.fileName = file.name;\n        const formData = new FormData();\n        formData.append('file', file);\n        this.http.post('/api/word-to-html', formData, {\n          responseType: 'text'\n        }).subscribe(htmlContent => {\n          this.editorContent = htmlContent;\n        }, error => {\n          console.error('Error uploading file:', error);\n        });\n      } else {\n        alert('Please upload a .docx file.');\n      }\n    }\n    saveEditedContent() {\n      if (!this.editorContent.trim()) {\n        alert('Editor is empty!');\n        return;\n      }\n      const payload = {\n        html: this.editorContent\n      };\n      this.http.post('/api/html-to-word', payload, {\n        responseType: 'blob'\n      }).subscribe(blob => {\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = this.fileName || 'edited.docx';\n        a.click();\n        URL.revokeObjectURL(url);\n      }, error => {\n        console.error('Error saving document:', error);\n      });\n    }\n    static ɵfac = function WordEditComponent_Factory(t) {\n      return new (t || WordEditComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: WordEditComponent,\n      selectors: [[\"app-word-edit\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 4,\n      vars: 1,\n      consts: [[\"type\", \"file\", \"accept\", \".docx\", 3, \"change\"], [4, \"ngIf\"], [\"rows\", \"15\", 2, \"width\", \"100%\", 3, \"ngModelChange\", \"ngModel\"], [3, \"click\"]],\n      template: function WordEditComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"h2\");\n          i0.ɵɵtext(1, \"\\u270F\\uFE0F Edit Word Document\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(2, \"input\", 0);\n          i0.ɵɵlistener(\"change\", function WordEditComponent_Template_input_change_2_listener($event) {\n            return ctx.onFileSelected($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(3, WordEditComponent_div_3_Template, 7, 1, \"div\", 1);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.editorContent);\n        }\n      },\n      dependencies: [CommonModule, i2.NgIf, HttpClientModule, FormsModule, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel]\n    });\n  }\n  return WordEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}